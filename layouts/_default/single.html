{{ define "main" }}
<h1>{{ .Title }}</h1>
<div class="post-content">{{ .Content }}</div>

<!-- Lightbox overlay -->
<div id="lightbox-overlay" class="hidden">
  <span id="lightbox-close">&times;</span>
  <img id="lightbox-img" src="">
  <span id="lightbox-prev">&#10094;</span>
  <span id="lightbox-next">&#10095;</span>
</div>

<style>
/* Grid 4 zdjęcia w rzędzie */
.post-content {
  width: 100%;
}

.post-gallery {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 10px;
  margin: 20px 0; /* opcjonalnie odstęp od tekstu */
}

.post-gallery img {
  width: 100%;
  cursor: pointer;
  border-radius: 0;
  transition: 0.2s;
}

.post-gallery img:hover { opacity: 0.8; }


#lightbox-overlay {
  position: fixed; top:0; left:0; width:100%; height:100%;
  background: rgba(0,0,0,0.9); display:flex; justify-content:center; align-items:center;
  z-index:9999;
}

#lightbox-overlay.hidden { display: none; }
#lightbox-img { max-width: 90%; max-height: 90%; border-radius: 0; } /* brak zaokrągleń */
#lightbox-close { position:absolute; top:20px; right:30px; font-size:40px; color:white; cursor:pointer; }
#lightbox-prev, #lightbox-next {
  position:absolute; top:50%; font-size:50px; color:white; cursor:pointer;
  user-select:none; transform:translateY(-50%);
}
#lightbox-prev { left:30px; }
#lightbox-next { right:30px; }
</style>

<script>
const overlay = document.getElementById('lightbox-overlay');
const lightboxImg = document.getElementById('lightbox-img');

// Wyłap wszystkie obrazki w treści posta
const images = Array.from(document.querySelectorAll('.post-content img'));

let current = 0;

function showImage(index) {
  current = (index + images.length) % images.length;
  lightboxImg.src = images[current].src;
}

images.forEach((img, i) => {
  img.style.cursor = 'pointer';  // wskaźnik kursora
  img.addEventListener('click', () => {
    overlay.classList.remove('hidden');
    showImage(i);
  });
});

document.getElementById('lightbox-close').addEventListener('click', () => overlay.classList.add('hidden'));
document.getElementById('lightbox-prev').addEventListener('click', () => showImage(current - 1));
document.getElementById('lightbox-next').addEventListener('click', () => showImage(current + 1));

document.addEventListener('keydown', e => {
  if (overlay.classList.contains('hidden')) return;
  if (e.key === 'ArrowLeft') showImage(current - 1);
  else if (e.key === 'ArrowRight') showImage(current + 1);
  else if (e.key === 'Escape') overlay.classList.add('hidden');
});
</script>

{{ end }}
