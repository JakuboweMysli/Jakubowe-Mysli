{{ define "main" }}
<h1>{{ .Title }}</h1>

<!-- Treść strony -->
<div class="page-content">
  {{ .Content }}
</div>

<!-- Galeria -->
<div class="gallery">
  {{ $images := readDir "assets/zdjecia" }}
  {{ range $images }}
    {{ if not .IsDir }}
      {{ $res := resources.Get (printf "zdjecia/%s" .Name) }}
      <div class="gallery-item">
        <a href="{{ $res.RelPermalink }}" class="lightbox">
          <img src="{{ $res.RelPermalink }}" alt="{{ .Name }}" class="thumb">
        </a>
      </div>
    {{ end }}
  {{ end }}
</div>

<!-- Lightbox overlay -->
<div id="lightbox-overlay" class="hidden">
  <span id="lightbox-close">&times;</span>
  <img id="lightbox-img" src="">
  <span id="lightbox-prev">&#10094;</span>
  <span id="lightbox-next">&#10095;</span>
</div>

<style>
/* Grid galerii */
.gallery {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 10px;
  margin: 20px 0; /* opcjonalnie odstęp od tekstu */
}
@media (max-width: 800px) { .gallery { grid-template-columns: repeat(2, 1fr); } }
@media (max-width: 500px) { .gallery { grid-template-columns: 1fr; } }

/* Kafelki i centrowanie miniatur pionowo */
.gallery-item {
  text-decoration: none;
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 150px; /* wysokość kafelka, możesz zmienić */
 }

.gallery-item a {
  display: inline-block;
}

.thumb {
  width: 100%;
  cursor: pointer;
  border-radius: 0;
  transition: 0.2s;
}
.thumb:hover { opacity: 0.8; }

/* Lightbox */
#lightbox-overlay {
  position: fixed; top:0; left:0; width:100%; height:100%;
  background: rgba(0,0,0,0.9); display:flex; justify-content:center; align-items:center;
  z-index:9999; 
}

#lightbox-overlay.hidden { display: none; }
#lightbox-img { max-width: 90%; max-height: 90%; border-radius: 0; } 
#lightbox-close { position:absolute; top:20px; right:30px; font-size:40px; color:white; cursor:pointer; }
#lightbox-prev, #lightbox-next {
  position:absolute; top:50%; font-size:50px; color:white; cursor:pointer;
  user-select:none; transform:translateY(-50%);
}
#lightbox-prev { left:30px; }
#lightbox-next { right:30px; }
</style>

<script>
const overlay = document.getElementById('lightbox-overlay');
const lightboxImg = document.getElementById('lightbox-img');
const images = Array.from(document.querySelectorAll('.gallery .thumb'));
let current = 0;

function showImage(index) {
  current = (index + images.length) % images.length;
  lightboxImg.src = images[current].parentElement.href;
}

images.forEach((img, i) => {
  img.addEventListener('click', e => {
    e.preventDefault();
    overlay.classList.remove('hidden');
    showImage(i);
  });
});

document.getElementById('lightbox-close').addEventListener('click', () => overlay.classList.add('hidden'));
document.getElementById('lightbox-prev').addEventListener('click', () => showImage(current - 1));
document.getElementById('lightbox-next').addEventListener('click', () => showImage(current + 1));

document.addEventListener('keydown', e => {
  if (overlay.classList.contains('hidden')) return;
  if (e.key === 'ArrowLeft') showImage(current - 1);
  else if (e.key === 'ArrowRight') showImage(current + 1);
  else if (e.key === 'Escape') overlay.classList.add('hidden');
});
</script>


<hr>

<div>
  <nav class="path-nav">
    <ol>
      {{ template "breadcrumbnav" (dict "p1" . "p2" .) }}
    </ol>
  </nav>
</div>

{{ end }}
